# 2.1.1 - Acesso ao ambiente

## Lab 2.0 - Objetivos

* Preparar o ambiente local para os próximos exercícios

## Tarefas

### 2.0.1 - Ambiente OpenShift
Para conseguirmos executar os próximos exercícios precisamos de um ambiente com o OpenShift instalado e disponível. Atualmente utilizamos máquinas virtuais na AWS onde temos um cluster Openshift está instalado representado pela figura abaixo:

![](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/common-environment-ocp-architecture.png)

Um número predefinido de usuários foi previamente criado no cluster para o test drive.

Antes de continuar acesse o Etherpad através do link abaixo:

```text
http://etherpad-ocp-workshop.apps.brasilia-ef40.open.redhat.com/p/workshop
```

Escolha um usuário dos predefinidos e coloque o seu nome na frente para indicar sua escolha.
Essa conta será utilizada por você durante todo o test drive. Por exemplo:

```text
user10=Luke Skywalker
```

Se o usuário já tiver um nome na frente significa que alguém já escolheu. Nesse caso escolha outro que esteja disponível.

## Linha de comando

The first thing we want to do to ensure that our `oc` command line tools was
installed and successfully added to our path is to log in to the OpenShift
environment that has been provided for this Workshop session. 


```text
https://terminal-ocp-workshop.apps.brasilia-ef40.open.redhat.com
```

You will need to log in with your OpenShift user and click on `Allow selected permissions`. You can then continue with the workshop.

In order to log in, we will use the `oc` command and then specify the server that we
want to authenticate to. Issue the following command:

```text
oc login https://master.brasilia-ef40.open.redhat.com
```

You may see the following output:

```text
The server uses a certificate signed by an unknown authority.
You can bypass the certificate check, but any data you send to the server could be intercepted by others.
Use insecure connections? (y/n):
```

Enter in *Y* to use a potentially insecure connection. The reason you received
this message is because we are using a self-signed certificate for this
workshop, but we did not provide you with the CA certificate that was generated
by OpenShift. In a real-world scenario, either OpenShift's certificate would be
signed by a standard CA (eg: Thawte, Verisign, StartSSL, etc.) or signed by a
corporate-standard CA that you already have installed on your system.

```text
oc login https://master.brasilia-ef40.open.redhat.com/ --insecure-skip-tls-verify=true
```

Once you issue the `oc login` command, you will be prompted for the username and
password combination for your user account. Use the username and password combination provided to you by the instructor of this workshop:

```text
Username: userXX
Password: xxxx
```

Once you have authenticated to the OpenShift server, you will see the
following confirmation message:

```text
Login successful.
Using project "userXX".
```

If you don't have any projects. You can try to create a new project, by running:

```text
oc new-project userXX
```

Congratulations, you are now authenticated to the OpenShift server. The
OpenShift master includes a built-in OAuth server. Developers and administrators
obtain OAuth access tokens to authenticate themselves to the API. By default
your authorization token will last for 24 hours. There is more information about
the login command and its configuration in the [Openshift Documentation](https://docs.openshift.com/container-platform/latest/cli_reference/get_started_cli.html#basic-setup-and-login).

**Using a Project**

Projects are a top level concept to help you organize your deployments. An
OpenShift project allows a community of users (or a user) to organize and manage
their content in isolation from other communities. Each project has its own
resources, policies (who can or cannot perform actions), and constraints (quotas
and limits on resources, etc). Projects act as a "wrapper" around all the
application services and endpoints you (or your teams) are using for your work.

During this lab, we are going to use a few different commands to make sure that
things in the environment are working as expected.  Don't worry if you don't
understand all of the terminology as we will cover it in detail in later labs.

If you didn't have a project already created for you, the first thing we want 
to do is create the *userXX* project. You can do this with the following command:

CAUTION: In the following command, replace `userXX` with the project provided to you.

```text
oc new-project userXX
```

You will see the following confirmation message:

```text
Now using project "userXX" on server "https://master.brasilia-ef40.open.redhat.com/".
```

If you had multiple projects, the first thing you would want to do is to switch 
to the *userXX* project to make sure you're on the correct project from now on. 
You can do this with the following command:

CAUTION: In the following command, replace `userXX` with the project provided to you.

```text
oc project userXX
```

You will see the following confirmation message:

```text
Now using project "userXX" on server "https://master.brasilia-ef40.open.redhat.com".
```

**The Web Console**

OpenShift ships with a web-based console that will allow users to
perform various tasks via a browser.  To get a feel for how the web console
works, open your browser and go to the following URL:

[Acessar a Web Console](https://master.brasilia-ef40.open.redhat.com)

The first screen you will see is the authentication screen. You will be prompted for the username and password combination for your user account. Use the username and password combination provided to you by the instructor of this workshop:

```text
Username: userXX
Password: xxxx
```

![OpenShift Login Screen](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/ocp-login.png)

After you have authenticated to the web console, you will be presented with a
list of items that you can add to your project. This is called the service catalog. You will see
something that looks like the following image:

![Web Console](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/explore-webconsole1sc.png)

Click on the *userXX* project on the right hand side of the screen. When you click on the
*userXX* project, you will be taken to the project overview page
which will list all of the routes, services, deployments, and pods that you have
running as part of your project. There's nothing there now, but that's about to
change.

![Explore Project](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/explore-webconsole2.png)

When the provided cluster has metrics aggregation capabilities configured you might see an 
error in the web console (when the cluster uses self signed certificates):

![Web Console](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/explore-webconsole2-error.png)

Click the link that says *Open metrics URL*, and accept the certificate.

![Accept Certificates](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/explore-acceptcertificate.png)

We need to accept another self-signed certificate for OpenShift's metrics
aggregation. If we don't, then the metrics will not display in the OpenShift UI.

![Hawkular Web](https://raw.githubusercontent.com/guaxinim/starter-guides/ocp-3.11/images/explore-hawkular.png)

We will be using a mix of command line tooling and the web console for the labs.
Get ready!
